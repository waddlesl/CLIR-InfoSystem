<style>
    /* 1. Card Layout for the History Section */
    .history-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        border: none;
        overflow: hidden;
    }

    /* 2. Custom Tab Container */
    .gray-tab-container {
        display: flex;
        background: #f1f3f5;
        padding: 5px;
        gap: 5px;
    }

    /* 3. Custom Tab Button */
    .gray-tab-btn {
        flex: 1;
        padding: 12px;
        cursor: pointer;
        background: transparent;
        color: #6c757d;
        border: none;
        border-radius: 10px;
        font-weight: 600;
        transition: all 0.3s ease;
        outline: none !important;
    }

        .gray-tab-btn:hover {
            background: rgba(108, 117, 125, 0.1);
            color: #333;
        }

        .gray-tab-btn.active-gray {
            background: white !important;
            color: #333 !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

    /* 4. Status Capsules */
    .capsule {
        padding: 4px 12px;
        border-radius: 50px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        display: inline-block;
    }

    .capsule-success {
        background: #d1e7dd;
        color: #0f5132;
    }

    .capsule-primary {
        background: #cfe2ff;
        color: #084298;
    }

    .capsule-info {
        background: #cff4fc;
        color: #055160;
    }

    .capsule-secondary {
        background: #e2e3e5;
        color: #41464b;
    }

    /* 5. Table Polish */
    .table thead th {
        background-color: #f8f9fa;
        text-transform: uppercase;
        font-size: 0.75rem;
        letter-spacing: 0.5px;
        border-bottom: 2px solid #dee2e6;
        color: #6c757d;
    }

    .custom-tab-content {
        padding: 20px;
    }
</style>

<div class="container mt-5" style="max-width: 900px;">
    <div class="text-center mb-4">
        <h2 class="fw-bold">📜 Activity History</h2>
        <p class="text-muted small">Keep track of your previous and upcoming requests.</p>
    </div>

    <div class="history-card">
        <div class="gray-tab-container" id="activityTab">
            <button class="gray-tab-btn active-gray" onclick="showTab(event, 'seats')">🪑 Seats</button>
            <button class="gray-tab-btn" onclick="showTab(event, 'odds')">📄 ODDS</button>
            <button class="gray-tab-btn" onclick="showTab(event, 'consult')">👨‍🏫 Consultations</button>
        </div>

        <div class="custom-tab-content">
            <div id="seats" class="tab-pane-custom">
                @if (ViewBag.SeatHistory != null && ((IEnumerable<dynamic>)ViewBag.SeatHistory).Any())
                {
                    <table class="table align-middle">
                        <thead><tr><th>Date</th><th>Slot</th><th class="text-center">Status</th></tr></thead>
                        <tbody>
                            @foreach (var item in ViewBag.SeatHistory)
                            {
                                <tr>
                                    <td class="fw-bold text-dark">@item.BookingDate.ToShortDateString()</td>
                                    <td>@item.TimeSlot?.DisplayText</td>
                                    <td class="text-center">
                                        <span class="capsule capsule-@(item.Status == "Completed" ? "success" : "primary")">
                                            @item.Status
                                        </span>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {

                    <p class="text-center py-4 text-muted small">No seat records found.</p>
                }
            </div>

            <div id="odds" class="tab-pane-custom" style="display:none">
                @if (ViewBag.OddsHistory != null && ((IEnumerable<dynamic>)ViewBag.OddsHistory).Any())
                {
                    <table class="table align-middle">
                        <thead><tr><th>Material</th><th>Request Date</th><th class="text-center">Status</th></tr></thead>
                        <tbody>
                            @foreach (var item in ViewBag.OddsHistory)
                            {
                                <tr>
                                    <td class="fw-bold">@item.MaterialType</td>
                                    <td>@item.RequestDate.ToShortDateString()</td>
                                    <td class="text-center"><span class="capsule capsule-info">@item.RequestStatus</span></td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {

                    <p class="text-center py-4 text-muted small">No document requests found.</p>
                }
            </div>

            <div id="consult" class="tab-pane-custom" style="display:none">
                @if (ViewBag.ConsultationHistory != null && ((IEnumerable<dynamic>)ViewBag.ConsultationHistory).Any())
                {
                    <table class="table align-middle">
                        <thead>
                            <tr><th>Topic</th><th>Date</th><th>Librarian</th><th class="text-center">Status</th></tr>
                        </thead>
                        <tbody>
                            @foreach (var item in ViewBag.ConsultationHistory)
                            {
                                <tr>
                                    <td class="fw-bold">@item.Topic</td>
                                    <td>@item.BookingDate.ToString("MMM dd, yyyy")</td>
                                    <td>@(item.Staff != null ? item.Staff.FirstName : "TBD")</td>
                                    <td class="text-center">
                                        <span class="capsule capsule-@(item.Status == "Approved" ? "success" : "info")">
                                            @item.Status
                                        </span>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {

                    <p class="text-center py-4 text-muted small">No librarian consultations found.</p>
                }
            </div>
        </div>
    </div>
</div>

<script>
    function showTab(evt, tabName) {
        var i, tabContent, tabBtns;
        tabContent = document.getElementsByClassName("tab-pane-custom");
        for (i = 0; i < tabContent.length; i++) {
            tabContent[i].style.display = "none";
        }
        tabBtns = document.getElementsByClassName("gray-tab-btn");
        for (i = 0; i < tabBtns.length; i++) {
            tabBtns[i].classList.remove("active-gray");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.classList.add("active-gray");
    }
</script>